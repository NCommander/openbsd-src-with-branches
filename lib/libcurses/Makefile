#	$OpenBSD: Makefile,v 1.18 1997/12/03 05:20:48 millert Exp $

# Uncomment this to enable tracing in libcurses
#CURSESTRACE=-DTRACE

LIB=    curses
SRCS=	define_key.c hardscroll.c hashmap.c keyok.c lib_acs.c lib_addch.c \
	lib_addstr.c lib_baudrate.c lib_beep.c lib_bkgd.c lib_box.c \
	lib_clear.c lib_clrbot.c lib_clreol.c lib_color.c lib_data.c \
	lib_delch.c lib_delwin.c lib_dft_fgbg.c lib_doupdate.c lib_endwin.c \
	lib_erase.c lib_flash.c lib_getch.c lib_getstr.c lib_hline.c \
	lib_inchstr.c lib_initscr.c lib_insch.c lib_insdel.c lib_insstr.c \
	lib_instr.c lib_isendwin.c lib_kernel.c lib_longname.c lib_mouse.c \
	lib_move.c lib_mvcur.c lib_mvwin.c lib_newterm.c lib_newwin.c \
	lib_options.c lib_overlay.c lib_pad.c lib_print.c lib_printw.c \
	lib_raw.c lib_redrawln.c lib_refresh.c lib_scanw.c lib_screen.c \
	lib_scroll.c lib_scrreg.c lib_set_term.c lib_slk.c lib_slkatrof.c \
	lib_slkatron.c lib_slkatrset.c lib_slkattr.c lib_slkclear.c \
	lib_slkinit.c lib_slklab.c lib_slkrefr.c lib_slkset.c lib_slktouch.c \
	lib_touch.c lib_tstp.c lib_twait.c lib_ungetch.c lib_vidattr.c \
	lib_vline.c lib_wattroff.c lib_wattron.c lib_window.c nc_panel.c \
	resizeterm.c safe_sprintf.c softscroll.c tries.c unctrl.c \
	wresize.c
SRCS+=	expanded.c lib_gen.c lib_keyname.c
.if defined(${CURSESTRACE})
SRCS+=	lib_trace.c lib_traceatr.c lib_tracechr.c lib_tracedmp.c \
	lib_tracemse.c trace_buf.c
.endif
CFLAGS+= -I. -I${.CURDIR} -DTERMIOS -DEXTERN_TERMINFO ${CURSESTRACE}
LDADD+=  -ltermlib
# XXX - add more MLINKS
MAN=	curs_addch.3 curs_addchstr.3 curs_addstr.3 curs_attr.3 curs_beep.3 \
	curs_bkgd.3 curs_border.3 curs_clear.3 curs_color.3 curs_delch.3 \
	curs_deleteln.3 curs_getch.3 curs_getstr.3 curs_getyx.3 curs_inch.3 \
	curs_inchstr.3 curs_initscr.3 curs_inopts.3 curs_insch.3 curs_insstr.3 \
	curs_instr.3 curs_kernel.3 curs_mouse.3 curs_move.3 curs_outopts.3 \
	curs_overlay.3 curs_pad.3 curs_print.3 curs_printw.3 curs_refresh.3 \
	curs_scanw.3 curs_scr_dmp.3 curs_scroll.3 curs_slk.3 curs_termattrs.3 \
	curs_touch.3 curs_util.3 curs_window.3 curses.3 define_key.3 \
	dft_fgbg.3 keyok.3 wresize.3
MLINKS+=curses.3 ncurses.3
CLEANFILES+= lib_gen.c lib_keyname.c keys.tries expanded.c

beforedepend: keys.tries

includes:
	@cd ${.CURDIR}; for i in unctrl.h; do \
	  cmp -s $$i ${DESTDIR}/usr/include/$$i || \
	  ${INSTALL} ${INSTALL_COPY} -m 444 -o $(BINOWN) -g $(BINGRP) $$i \
	  ${DESTDIR}/usr/include; done
	@cd ${.CURDIR}; cmp -s curses.h ${DESTDIR}/usr/include/curses.h || \
	  ${INSTALL} ${INSTALL_COPY} -m 444 -o $(BINOWN) -g $(BINGRP) curses.h \
	  ${DESTDIR}/usr/include

keys.tries: ${.CURDIR}/keys.list ${.CURDIR}/MKkeys.awk
	awk -f ${.CURDIR}/MKkeys.awk ${.CURDIR}/keys.list > keys.tries

lib_keyname.c: ${.CURDIR}/keys.list ${.CURDIR}/MKkeyname.awk
	awk -f ${.CURDIR}/MKkeyname.awk ${.CURDIR}/keys.list > lib_keyname.c

lib_gen.c: ${.CURDIR}/curses.h ${.CURDIR}/MKlib_gen.sh
	sh ${.CURDIR}/MKlib_gen.sh "${CPP}" "awk" < ${.CURDIR}/curses.h > lib_gen.c

expanded.c: ${.CURDIR}/curses.h ${.CURDIR}/MKexpanded.sh
	sh ${.CURDIR}/MKexpanded.sh "${CPP}" ${CPPFLAGS}

.include <bsd.lib.mk>

lib_options.o lib_options.so lib_options.po lib_options.ln: keys.tries
