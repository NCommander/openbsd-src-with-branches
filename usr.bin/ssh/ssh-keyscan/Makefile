#	$OpenBSD: Makefile,v 1.7 2017/07/10 14:09:59 espie Exp $

.PATH:		${.CURDIR}/..

SRCS=	ssh-keyscan.c

umac128.c: umac.c
	sed \
	    -e "s/^#define UMAC_OUTPUT_LEN     8/#define UMAC_OUTPUT_LEN 16/" \
	    -e s/umac_new/umac128_new/g \
	    -e s/umac_update/umac128_update/g \
	    -e s/umac_final/umac128_final/g \
	    -e s/umac_delete/umac128_delete/g \
	    < ${.CURDIR}/../umac.c > ${.TARGET}

SRCS+=	addrmatch.c atomicio.c blocks.c canohost.c chacha.c \
	cipher-chachapoly.c cipher.c cleanup.c compat.c dh.c digest-openssl.c \
	dispatch.c ed25519.c fe25519.c ge25519.c hash.c hmac.c hostfile.c \
	kex.c kexc25519.c kexc25519c.c kexc25519s.c kexdh.c kexdhc.c kexdhs.c \
	kexecdh.c kexecdhc.c kexecdhs.c kexgex.c kexgexc.c kexgexs.c log.c \
	mac.c match.c misc.c packet.c poly1305.c sc25519.c \
	smult_curve25519_ref.c ssh-dss.c ssh-ecdsa.c ssh-ed25519.c ssh-rsa.c \
	ssh_api.c sshbuf-getput-basic.c sshbuf-getput-crypto.c sshbuf-misc.c \
	sshbuf.c ssherr.c sshkey.c uidswap.c umac.c umac128.c verify.c \
	xmalloc.c

PROG=	ssh-keyscan
BINOWN=	root

BINMODE?=555

BINDIR=	/usr/bin

.include <bsd.prog.mk>

LDADD+= -lcrypto -lz -lutil
DPADD+= ${LIBCRYPTO} ${LIBZ} ${LIBUTIL}

