#	$OpenBSD: ipsec.conf,v 1.1.1.1 2017/02/06 21:54:05 bluhm Exp $
### regress ipsec ipsec.conf

# Install symmetric config by exchanging local and peer keywords.
FROM="from"
TO="to"
LOCAL="local"
PEER="peer"

# TRANSP

flow esp \
	$FROM	$SRC_TRANSP_IPV4	$TO	$IPS_TRANSP_IPV4 \
	$LOCAL	$SRC_TRANSP_IPV4	$PEER	$IPS_TRANSP_IPV4 \
	type	dontacq
flow esp \
	$FROM	$SRC_TRANSP_IPV6	$TO	$IPS_TRANSP_IPV6 \
	$LOCAL	$SRC_TRANSP_IPV6	$PEER	$IPS_TRANSP_IPV6 \
	type	dontacq

# TRANSP SA

esp transport \
	from	$SRC_TRANSP_IPV4	to	$IPS_TRANSP_IPV4 \
	spi	0x10000441:0x10000442 \
	authkey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef \
	enckey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

esp transport \
	from	$SRC_TRANSP_IPV6	to	$IPS_TRANSP_IPV6 \
	spi	0x10000461:0x10000462 \
	authkey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef \
	enckey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# TUNNEL IPS

flow esp \
	$FROM	$SRC_TUNNEL_IPV4/24	$TO	$IPS_TUNNEL4_IPV4/24 \
	$LOCAL	$SRC_OUT_IPV4		$PEER	$IPS_IN_IPV4 \
	type	dontacq
flow esp \
	$FROM	$SRC_TUNNEL_IPV6/64	$TO	$IPS_TUNNEL4_IPV6/64 \
	$LOCAL	$SRC_OUT_IPV4		$PEER	$IPS_IN_IPV4 \
	type	dontacq

flow esp \
	$FROM	$SRC_TUNNEL_IPV4/24	$TO	$IPS_TUNNEL6_IPV4/24 \
	$LOCAL	$SRC_OUT_IPV6		$PEER	$IPS_IN_IPV6 \
	type	dontacq
flow esp \
	$FROM	$SRC_TUNNEL_IPV6/64	$TO	$IPS_TUNNEL6_IPV6/64 \
	$LOCAL	$SRC_OUT_IPV6		$PEER	$IPS_IN_IPV6 \
	type	dontacq

# TUNNEL ECO

flow esp \
	$FROM	$SRC_TUNNEL_IPV4/24	$TO	$ECO_TUNNEL4_IPV4/24 \
	$LOCAL	$SRC_OUT_IPV4		$PEER	$IPS_IN_IPV4 \
	type	dontacq
flow esp \
	$FROM	$SRC_TUNNEL_IPV6/64	$TO	$ECO_TUNNEL4_IPV6/64 \
	$LOCAL	$SRC_OUT_IPV4		$PEER	$IPS_IN_IPV4 \
	type	dontacq

flow esp \
	$FROM	$SRC_TUNNEL_IPV4/24	$TO	$ECO_TUNNEL6_IPV4/24 \
	$LOCAL	$SRC_OUT_IPV6		$PEER	$IPS_IN_IPV6 \
	type	dontacq
flow esp \
	$FROM	$SRC_TUNNEL_IPV6/64	$TO	$ECO_TUNNEL6_IPV6/64 \
	$LOCAL	$SRC_OUT_IPV6		$PEER	$IPS_IN_IPV6 \
	type	dontacq

# TUNNEL SA

esp tunnel \
	from	$SRC_OUT_IPV4	to	$IPS_IN_IPV4 \
	spi	0x10000841:0x10000842 \
	authkey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef \
	enckey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

esp tunnel \
	from	$SRC_OUT_IPV6	to	$IPS_IN_IPV6 \
	spi	0x10000861:0x10000862 \
	authkey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef \
	enckey	0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef:0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
